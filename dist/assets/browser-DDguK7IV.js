function nt(W,O){for(var G=0;G<O.length;G++){const E=O[G];if(typeof E!="string"&&!Array.isArray(E)){for(const a in E)if(a!=="default"&&!(a in W)){const m=Object.getOwnPropertyDescriptor(E,a);m&&Object.defineProperty(W,a,m.get?m:{enumerable:!0,get:()=>E[a]})}}}return Object.freeze(Object.defineProperty(W,Symbol.toStringTag,{value:"Module"}))}function et(W){return W&&W.__esModule&&Object.prototype.hasOwnProperty.call(W,"default")?W.default:W}function it(W){throw new Error('Could not dynamically require "'+W+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var V={exports:{}};V.exports;var Z;function rt(){return Z||(Z=1,(function(W){(function(){function O(E,a){return a?it(E):E.slice?O[m(E)]:function(d,v){E(d={exports:{}}),O[m(v)]=d.exports};function m(d){return d.split("/").slice(-1).toString().replace(".js","")}}var G=W;O(function(E){String.random=function(m,d){var v="";for(m=m||24,d=d||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";m-- >0;)v+=d.charAt(Math.floor(Math.random()*d.length));return v},String.match=function(m,d){var v,b;return typeof m!="string"?!1:(typeof d=="string"&&(d={"=":d}),d=d||{},v=d["="]||d["*"]||d[">"]||d["<"],m===v?!0:b!==d["="]?!1:(v=d["*"]||d[">"],m.slice(0,(v||"").length)===v?!0:b!==d["*"]?!1:b!==d[">"]&&b!==d["<"]?m>=d[">"]&&m<=d["<"]:b!==d[">"]&&m>=d[">"]||b!==d["<"]&&m<=d["<"]))},String.hash=function(m,d){if(typeof m=="string"){if(d=d||0,!m.length)return d;for(var v=0,b=m.length,c;v<b;++v)c=m.charCodeAt(v),d=(d<<5)-d+c,d|=0;return d}};var a=Object.prototype.hasOwnProperty;Object.plain=function(m){return m?m instanceof Object&&m.constructor===Object||Object.prototype.toString.call(m).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(m,d){for(var v in m)if(a.call(m,v)&&(!d||d.indexOf(v)==-1))return!1;return!0},Object.keys=Object.keys||function(m){var d=[];for(var v in m)a.call(m,v)&&d.push(v);return d},(function(){var m,d=setTimeout,v=0,b=0,c=typeof setImmediate!=""+m&&setImmediate||(function(u,w){return typeof MessageChannel==""+m?d:((u=new MessageChannel).port1.onmessage=function(D){D.data==""&&w()},function(D){w=D,u.port2.postMessage("")})})(),f=d.check=d.check||typeof performance!=""+m&&performance||{now:function(){return+new Date}};d.hold=d.hold||9,d.poll=d.poll||function(u){if(d.hold>=f.now()-v&&b++<3333){u();return}c(function(){v=f.now(),u()},b=0)}})(),(function(){var m=setTimeout,d=m.turn=m.turn||function(w){v.push(w)==1&&b(u)},v=d.s=[],b=m.poll,c=0,f,u=function(){(f=v[c++])&&f(),(c==v.length||c==99)&&(v=d.s=v.slice(c),c=0),v.length&&b(u)}})(),(function(){var m,d=setTimeout,v=d.turn;(d.each=d.each||function(b,c,f,u){u=u||9,(function w(D,o,k){if(o=(D=(b||[]).splice(0,u)).length){for(var h=0;h<o&&m===(k=c(D[h]));h++);if(m===k){v(w);return}}f&&f(k)})()})()})()})(O,"./shim"),O(function(E){E.exports=function a(f,d,v){if(!f)return{to:a};var b,c=typeof d=="function",f=(this.tag||(this.tag={}))[f]||c&&(this.tag[f]={tag:f,to:a._={next:function(w){var D;(D=this.to)&&D.next(w)}}});if(c){var u={off:a.off||(a.off=function(){if(this.next===a._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=a._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:a._,next:d,the:f,on:this,as:v};return(u.back=f.last||f).to=u,f.last=u}return(f=f.to)&&b!==d&&f.next(d),f}})(O,"./onto"),O(function(E){E.exports=function(a){return a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"&&a!=1/0&&a!=-1/0&&a===a||!!a&&typeof a["#"]=="string"&&Object.keys(a).length===1&&a["#"]}})(O,"./valid"),O(function(E){O("./shim");function a(){var f=+new Date;return b<f?(d=0,b=f+a.drift):b=f+(d+=1)/v+a.drift}a.drift=0;var m=-1/0,d=0,v=999,b=m,c;a.is=function(f,u,w){var D=u&&f&&f._&&f._[">"]||w;if(D)return typeof(D=D[u])=="number"?D:m},a.ify=function(f,u,w,D,o){(f=f||{})._=f._||{},o&&(f._["#"]=o);var k=f._[">"]||(f._[">"]={});return c!==u&&u!=="_"&&(typeof w=="number"&&(k[u]=w),c!==D&&(f[u]=D)),f},E.exports=a})(O,"./state"),O(function(E){O("./shim");function a(m){var d={s:{}},v=d.s;m=m||{max:999,age:1e3*9},d.check=function(c){return v[c]?b(c):!1};var b=d.track=function(c){var f=v[c]||(v[c]={});return f.was=d.now=+new Date,d.to||(d.to=setTimeout(d.drop,m.age+9)),b.ed&&b.ed(c),f};return d.drop=function(c){d.to=null,d.now=+new Date;var f=Object.keys(v);console.STAT&&console.STAT(d.now,+new Date-d.now,"dup drop keys"),setTimeout.each(f,function(u){var w=v[u];w&&(c||m.age)>d.now-w.was||delete v[u]},0,99)},d}E.exports=a})(O,"./dup"),O(function(E){O("./onto"),E.exports=function(d,v){if(this.on){var b=(this.opt||{}).lack||9e3;if(typeof d!="function"){if(!d)return;var f=d["#"]||d,c=(this.tag||"")[f];return c?(v&&(c=this.on(f,v),clearTimeout(c.err),c.err=setTimeout(function(){c.off()},b)),!0):void 0}var f=v&&v["#"]||a(9);if(!d)return f;var u=this.on(f,d,v);return u.err=u.err||setTimeout(function(){u.off(),u.next({err:"Error: No ACK yet.",lack:!0})},b),f}};var a=String.random||function(){return Math.random().toString(36).slice(2)}})(O,"./ask"),O(function(E){function a(o){return o instanceof a?(this._={$:this}).$:this instanceof a?a.create(this._={$:this,opt:o}):new a(o)}a.is=function(o){return o instanceof a||o&&o._&&o===o._.$||!1},a.version=.202,a.chain=a.prototype,a.chain.toJSON=function(){},O("./shim"),a.valid=O("./valid"),a.state=O("./state"),a.on=O("./onto"),a.dup=O("./dup"),a.ask=O("./ask"),(function(){a.create=function(t){t.root=t.root||t,t.graph=t.graph||{},t.on=t.on||a.on,t.ask=t.ask||a.ask,t.dup=t.dup||a.dup();var i=t.$.opt(t.opt);return t.once||(t.on("in",o,t),t.on("out",o,t),t.on("put",x,t),a.on("create",t),t.on("create",t)),t.once=1,i};function o(t){if(t){if(t.out===o){this.to.next(t);return}var i=this,l=i.as,$=l.at||l,T=$.$,j=$.dup,A,I=t.DBG;if((A=t["#"])||(A=t["#"]=d(9)),!j.check(A)){if(j.track(A),A=t._,t._=typeof A=="function"?A:function(){},t.$&&t.$===(t.$._||"").$||(t.$=T),t["@"]&&!t.put&&n(t),!$.ask(t["@"],t))if(I&&(I.u=+new Date),t.put){k(t);return}else t.get&&a.on.get(t,T);I&&(I.uc=+new Date),i.to.next(t),I&&(I.ua=+new Date),!(t.nts||t.NTS)&&(t.out=o,$.on("out",t),I&&(I.ue=+new Date))}}}function k(t){if(t){var i=t._||"",l=i.root=((i.$=t.$||"")._||"").root;if(t["@"]&&i.faith&&!i.miss){t.out=o,l.on("out",t);return}i.latch=l.hatch,i.match=l.hatch=[];var $=t.put,T=i.DBG=t.DBG,j=+new Date;if(N=N||j,!($["#"]&&$["."])){T&&(T.p=j),i["#"]=t["#"],i.msg=t,i.all=0,i.stun=1;var A=Object.keys($);console.STAT&&console.STAT(j,((T||i).pk=+new Date)-j,"put sort");var I=0,M,J,P,q,C,R,H;(function U(z){if(M!=I){if(M=I,!(P=A[I])){console.STAT&&console.STAT(j,((T||i).pd=+new Date)-j,"put"),y(i);return}(q=$[P])?(H=q._)?P!==H["#"]?R=p+g(P)+"soul not same.":(C=H[">"])||(R=p+g(P)+"no state."):R=p+g(P)+"no meta.":R=p+g(P)+"no node.",J=Object.keys(q||{})}if(R){t.err=i.err=R,y(i);return}var X=0,F;for(z=z||0;z++<9&&(F=J[X++]);)if(F!=="_"){var K=q[F],Y=C[F];if(u===Y){R=p+g(F)+"on"+g(P)+"no state.";break}if(!b(K)){R=p+g(F)+"on"+g(P)+"bad "+typeof K+g(K);break}h(K,F,P,Y,t),++B}if((J=J.slice(X)).length){v(U);return}++I,J=null,U(z)})()}}}a.on.put=k;function h(t,i,l,$,T){var j=T._||"",A=j.root,I=A.graph,M,J=I[l]||w,P=c(J,i,1),q=J[i],C=j.DBG;(M=console.STAT)&&(!I[l]||!q)&&(M.has=(M.has||0)+1);var R=S();if($>R){setTimeout(function(){h(t,i,l,$,T)},(M=$-R)>_?_:M),console.STAT&&console.STAT((C||j).Hf=+new Date,M,"future");return}if(!($<P)&&!(!j.faith&&$===P&&(t===q||s(t)<=s(q))&&!j.miss)){j.stun++;var H=T["#"]+j.all++,U={toString:function(){return H},_:j};U.toJSON=U.toString,A.dup.track(U)["#"]=T["#"],C&&(C.ph=C.ph||+new Date),A.on("put",{"#":U,"@":T["@"],put:{"#":l,".":i,":":t,">":$},ok:T.ok,_:j})}}function x(t){var i;(i=(t._||"").DBG)&&(i.pa=+new Date,i.pm=i.pm||+new Date);var l=this,$=l.as,T=$.graph,j=t._,A=t.put,I=A["#"],M=A["."],J=A[":"],P=A[">"];t["#"];var q;(q=j.msg)&&(q=q.put)&&(q=q[I])&&f(q,M,P,J,I),T[I]=f(T[I],M,P,J,I),(q=($.next||"")[I])&&q.on("in",t),y(j),l.to.next(t)}function y(t,i){var l;if(!t.stop&&!(!t.err&&0<--t.stun)&&(t.stop=1,!!(l=t.root))){var $=t.match;$.end=1,$===l.hatch&&(!($=t.latch)||$.end?delete l.hatch:l.hatch=$),t.hatch&&t.hatch(),setTimeout.each(t.match,function(T){T&&T()}),!(!(i=t.msg)||t.err||i.err)&&(i.out=o,t.root.on("out",i),e())}}function n(t){var i=t["@"]||"",l;if(!(l=i._)){var $=($=t.$)&&($=$._)&&($=$.root)&&($=$.dup);if(!($=$.check(i)))return;t["@"]=$["#"]||t["@"];return}l.acks=(l.acks||0)+1,(l.err=t.err)&&(t["@"]=l["#"],y(l)),l.ok=t.ok||l.ok,!l.stop&&!l.crack&&(l.crack=l.match&&l.match.push(function(){r(l)})),r(l)}function r(t){!t||!t.root||t.stun||t.acks!==t.all||t.root.on("in",{"@":t["#"],err:t.err,ok:t.err?u:t.ok||{"":1}})}var p="Error: Invalid graph!",g=function(t){return" '"+(""+t).slice(0,9)+"...' "},s=JSON.stringify,_=2147483647,S=a.state,B=0,N,e=function(){B>999&&B/-(N-(N=+new Date))>1&&(a.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),e=function(){B=0})}})(),(function(){a.on.get=function(k,h){var x=h._,y=k.get,n=y["#"],r=x.graph[n],p=y["."],g=x.next||(x.next={}),s=g[n],_=k._||{},S=_.DBG=k.DBG;if(S&&(S.g=+new Date),!r)return x.on("get",k);if(p){if((typeof p!="string"||u===r[p])&&!((s||"").next||"")[p]){x.on("get",k);return}r=f({},p,c(r,p),r[p],n)}r&&o(k,r),x.on("get",k)};function o(k,h){var x=+new Date,y=k._||{},n=y.DBG=k.DBG,r=k["#"],p=d(9),g=Object.keys(h||"").sort(),s=((h||"")._||"")["#"];g.length;var _=k.$._.root,S=h===_.graph[s];console.STAT&&console.STAT(x,((n||y).gk=+new Date)-x,"got keys"),h&&(function B(){x=+new Date;for(var N=0,e,t={},i;N<9&&(e=g[N++]);)f(t,e,c(h,e),h[e],s);g=g.slice(N),(i={})[s]=t,t=i;var l;S&&(l=function(){},l.ram=l.faith=!0),i=g.length,console.STAT&&console.STAT(x,-(x-(x=+new Date)),"got copied some"),n&&(n.ga=+new Date),_.on("in",{"@":r,"#":p,put:t,"%":i?p=d(9):u,$:_.$,_:l,DBG:n,FOO:1}),console.STAT&&console.STAT(x,+new Date-x,"got in"),i&&setTimeout.turn(B)})(),h||_.on("in",{"@":k["#"]})}a.on.get.ack=o})(),(function(){a.chain.opt=function(o){o=o||{};var k=this,h=k._,x=o.peers||o;return Object.plain(o)||(o={}),Object.plain(h.opt)||(h.opt=o),typeof x=="string"&&(x=[x]),Object.plain(h.opt.peers)||(h.opt.peers={}),x instanceof Array&&(o.peers={},x.forEach(function(y){var n={};n.id=n.url=y,o.peers[y]=h.opt.peers[y]=h.opt.peers[y]||n})),m(o,function y(n){var r=this[n];if(this&&this.hasOwnProperty(n)||typeof r=="string"||Object.empty(r)){this[n]=r;return}r&&r.constructor!==Object&&!(r instanceof Array)||m(r,y)}),h.opt.from=o,a.on("opt",h),h.opt.uuid=h.opt.uuid||function(n){return a.state().toString(36).replace(".","")+String.random(n||12)},k}})();var m=function(o,k){Object.keys(o).forEach(k,o)},d=String.random,v=setTimeout.turn,b=a.valid,c=a.state.is,f=a.state.ify,u,w={},D;a.log=function(){return!a.log.off&&D.log.apply(D,arguments),[].slice.call(arguments).join(" ")},a.log.once=function(o,k,h){return(h=a.log.once)[o]=h[o]||0,h[o]++||a.log(k)},typeof window<"u"&&((window.GUN=window.Gun=a).window=window);try{typeof G<"u"&&(G.exports=a)}catch{}E.exports=a,(a.window||{}).console=(a.window||{}).console||{log:function(){}},(D=console).only=function(o,k){return D.only.i&&o===D.only.i&&D.only.i++&&(D.log.apply(D,arguments)||k)},a.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(O,"./root"),O(function(E){var a=O("./root");a.chain.back=function(v,b){var c;if(v=v||1,v===-1||v===1/0)return this._.root.$;if(v===1)return(this._.back||this._).$;var f=this,u=f._;if(typeof v=="string"&&(v=v.split(".")),v instanceof Array){var w=0,D=v.length,c=u;for(w;w<D;w++)c=(c||m)[v[w]];return d!==c?b?f:c:(c=u.back)?c.$.back(v,b):void 0}if(typeof v=="function"){for(var o,c={back:u};(c=c.back)&&d===(o=v(c,b)););return o}return typeof v=="number"?(u.back||u).$.back(v-1):this};var m={},d})(O,"./back"),O(function(E){var a=O("./root");a.chain.chain=function(y){var n=this,r=n._,p=new(y||n).constructor(n),g=p._,s;return g.root=s=r.root,g.id=++s.once,g.back=n._,g.on=a.on,g.on("in",a.on.in,g),g.on("out",a.on.out,g),p};function m(y){var n,r=this.as,p=r.back,g=r.root,s;if(y.$||(y.$=r.$),this.to.next(y),r.err){r.on("in",{put:r.put=u,$:r.$});return}if(n=y.get){if(g.pass&&(g.pass[r.id]=r),r.lex&&Object.keys(r.lex).forEach(function(_){s[_]=r.lex[_]},s=y.get=y.get||{}),n["#"]||r.soul){if(n["#"]=n["#"]||r.soul,y["#"]||(y["#"]=w(9)),p=g.$.get(n["#"])._,n=n["."]){if(o(p.put,n)&&(s=p.ask&&p.ask[n],(p.ask||(p.ask={}))[n]=p.$.get(n)._,p.on("in",{get:n,put:{"#":p.soul,".":n,":":p.put[n],">":h(g.graph[p.soul],n)}}),s))return}else{if(s=p.ask&&p.ask[""],(p.ask||(p.ask={}))[""]=p,u!==p.put&&(p.on("in",p),s))return;y.$=p.$}return g.ask(c,y),g.on("in",y)}if(n["."])return r.get?(y={get:{".":r.get},$:r.$},(p.ask||(p.ask={}))[r.get]=y.$._,p.on("out",y)):(y={get:r.lex?y.get:{},$:r.$},p.on("out",y));if((r.ask||(r.ask={}))[""]=r,r.get)return n["."]=r.get,(p.ask||(p.ask={}))[r.get]=y.$._,p.on("out",y)}return p.on("out",y)}a.on.out=m;function d(y,n){n=n||this.as;var r=n.root,p=y.$||(y.$=n.$),g=(p||"")._||f,s=y.put||"",_=s["#"],S=s["."],B=u!==s["="]?s["="]:s[":"],N=s[">"]||-1/0,e;if(u!==y.put&&(u===s["#"]||u===s["."]||u===s[":"]&&u===s["="]||u===s[">"])){if(!D(s)){if(!(_=((s||"")._||"")["#"])){console.log("chain not yet supported for",s,"...",y,n);return}return p=n.root.$.get(_),setTimeout.each(Object.keys(s).sort(),function(t){t=="_"||u===(N=h(s,t))||n.on("in",{$:p,put:{"#":_,".":t,"=":s[t],">":N},VIA:y})})}n.on("in",{$:g.back.$,put:{"#":_=g.back.soul,".":S=g.has||g.get,"=":s,">":h(g.back.put,S)},via:y});return}(y.seen||"")[n.id]||((y.seen||(y.seen=function(){}))[n.id]=n,n!==g&&(Object.keys(y).forEach(function(t){s[t]=y[t]},s={}),s.get=n.get||s.get,!n.soul&&!n.has?s.$$$=s.$$$||n.$:g.soul&&(s.$=n.$,s.$$=s.$$||g.$),y=s),b(y,n),(n.soul||y.$$)&&N>=h(r.graph[_],S)&&((s=r.$.get(_)._).put=x(s.put,S,N,B,_)),!g.soul&&N>=h(r.graph[_],S)&&(e=(r.$.get(_)._.next||"")[S])&&(e.put=B,typeof(s=D(B))=="string"&&(e.put=r.$.get(s)._.put||B)),this.to&&this.to.next(y),n.any&&setTimeout.each(Object.keys(n.any),function(t){(t=n.any[t])&&t(y)},0,99),n.echo&&setTimeout.each(Object.keys(n.echo),function(t){(t=n.echo[t])&&t.on("in",y)},0,99),((y.$$||"")._||g).soul&&(e=n.next)&&(e=e[S])&&(s={},Object.keys(y).forEach(function(t){s[t]=y[t]}),s.$=(y.$$||y.$).get(s.get=S),delete s.$$,delete s.$$$,e.on("in",s)),v(y,n))}a.on.in=d;function v(y,n){if(n=n||this.as||y.$._,!(y.$$&&this!==a.on)&&!(!y.put||n.soul)){var r=y.put||"",p=r["="]||r[":"],S,g=n.root,s=g.$.get(r["#"]).get(r["."])._;if(typeof(p=D(p))!="string"){this===a.on&&((s.echo||(s.echo={}))[n.id]=n);return}if(!((s.echo||(s.echo={}))[n.id]&&!(g.pass||"")[n.id])){if(S=g.pass){if(S[p+n.id])return;S[p+n.id]=1}(s.echo||(s.echo={}))[n.id]=n,n.has&&(n.link=p);var _=g.$.get(s.link=p)._;(_.echo||(_.echo={}))[s.id]=s;var S=n.ask||"";(S[""]||n.lex)&&_.on("out",{get:{"#":p}}),setTimeout.each(Object.keys(S),function(B,N){!B||!(N=S[B])||N.on("out",{get:{"#":p,".":B}})},0,99)}}}a.on.link=v;function b(y,n){var r=y.put||"",p=u!==r["="]?r["="]:r[":"],g=n.root,s,_;if(u===p){if(n.soul&&u!==n.put||(_=(y.$$||y.$||"")._||"",y["@"]&&(u!==_.put||u!==n.put)))return;(s=n.link||y.linked)&&delete(g.$.get(s)._.echo||"")[n.id],n.has&&(n.link=null),n.put=u,setTimeout.each(Object.keys(n.next||""),function(S,B){(B=n.next[S])&&(s&&delete(g.$.get(s).get(S)._.echo||"")[B.id],B.on("in",{get:S,put:u,$:B.$}))},0,99);return}n.soul||y.$$||(s=D(p),_=y.$._||"",!((s===_.link||n.has&&!_.link)&&!((g.pass||"")[n.id]&&typeof s!="string"))&&(delete(_.echo||"")[n.id],b({get:n.get,put:u,$:y.$,linked:y.linked=y.linked||_.link},n)))}a.on.unlink=b;function c(y,n){var r=this.as,p=r.$._;p.root;var g=r.get||"",s=(y.put||"")[g["#"]]||"";if(!y.put||typeof g["."]=="string"&&u===s[g["."]]){if(u!==p.put||!p.soul&&!p.has)return;p.ack=(p.ack||0)+1,p.on("in",{get:p.get,put:p.put=u,$:p.$,"@":y["@"]});return}(y._||{}).miss=1,a.on.put(y)}var f={},u,w=String.random,D=a.valid,o=function(y,n){return y&&Object.prototype.hasOwnProperty.call(y,n)},k=a.state,h=k.is,x=k.ify})(O,"./chain"),O(function(E){var a=O("./root");a.chain.get=function(u,w,D){var o,k;if(typeof u=="string"){if(u.length==0)return(o=this.chain())._.err={err:a.log("0 length key!",u)},w&&w.call(o,o._.err),o;var h=this,x=h._,y=x.next||b;(o=y[u])||(o=u&&m(u,h)),o=o&&o.$}else if(typeof u=="function"){let _=function(S,B,N){if(!_.stun&&!((T=r.pass)&&!T[p])){var e=S.$._,t=(S.$$||"")._,i=(t||e).put,l=!e.has&&!e.soul,$={},T;if((l||f===i)&&(i=f===((T=S.put)||"")["="]?f===(T||"")[":"]?T:T[":"]:T["="]),typeof(T=a.valid(i))=="string"&&(i=f===(T=r.$.get(T)._.put)?n.not?f:i:T),!(n.not&&f===i)){if(f===n.stun){if((T=r.stun)&&T.on&&(x.$.back(function(j){if(T.on(""+j.id,$={}),($.run||0)<_.id)return $}),!$.run&&T.on(""+e.id,$={}),!$.run&&t&&T.on(""+t.id,$={}),_.id>$.run&&((!$.stun||$.stun.end)&&($.stun=T.on("stun"),$.stun=$.stun&&$.stun.last),$.stun&&!$.stun.end))){($.stun.add||($.stun.add={}))[p]=function(){_(S,B,1)};return}if(f===i&&(N=0),(T=r.hatch)&&!T.end&&f===n.hatch&&!N){if(g[e.$._.id])return;g[e.$._.id]=1,T.push(function(){_(S,B,1)});return}g={}}if(r.pass){if(r.pass[p+e.id])return;r.pass[p+e.id]=1}if(n.on){n.ok.call(e.$,i,e.get,S,B||_);return}if(n.v2020){n.ok(S,B||_);return}Object.keys(S).forEach(function(j){T[j]=S[j]},T={}),S=T,S.put=i,n.ok.call(n.as,S,B||_)}}};if(w===!0)return d(this,u,w,D),this;o=this;var x=o._,n=w||{},r=x.root,p;n.at=x,n.ok=u;var g={};return _.at=x,(x.any||(x.any={}))[p=String.random(7)]=_,_.off=function(){_.stun=1,x.any&&delete x.any[p]},_.rid=v,_.id=n.run||++r.once,k=r.pass,(r.pass={})[p]=1,n.out=n.out||{get:{}},x.on("out",n.out),r.pass=k,o}else{if(typeof u=="number")return this.get(""+u,w,D);if(typeof(k=c(u))=="string")return this.get(k,w,D);(k=this.get.next)&&(o=k(this,u))}return o?(w&&typeof w=="function"&&o.get(w,D),o):((o=this.chain())._.err={err:a.log("Invalid get request!",u)},w&&w.call(o,o._.err),o)};function m(u,w){var D=w._,o=D.next,k=w.chain(),h=k._;return o||(o=D.next={}),o[h.get=u]=h,w===D.root.$?h.soul=u:(D.soul||D.has)&&(h.has=u),h}function d(u,w,D,o){var k=u._,h=0,x;return(x=k.soul||k.link)?w(x,o,k):k.jam?k.jam.push([w,o]):(k.jam=[[w,o]],u.get(function(n,r){if(!(f===n.put&&!k.root.opt.super&&(x=Object.keys(k.root.opt.peers).length)&&++h<=x)){r.rid(n);var p=(p=n.$)&&p._||{},g=0,s;for(x=k.jam,delete k.jam;s=x[g++];){var _=s[0];s=s[1],_&&_(p.link||p.soul||a.valid(n.put)||((n.put||{})._||{})["#"],s,n,r)}}},{out:{get:{".":!0}}}),u)}function v(u){var w=this.at||this.on;if(!u||w.soul||w.has)return this.off();if(u=(u=(u=u.$||u)._||u).id){w.map;var D;if((D=this.seen||(this.seen={}))[u])return!0;D[u]=!0}}var b={},c=a.valid,f})(O,"./get"),O(function(E){var a=O("./root");a.chain.put=function(o,k,h){var x=this,y=x._,n=y.root;h=h||{},h.root=y.root,h.run||(h.run=n.once),m(h,y.id),h.ack=h.ack||k,h.via=h.via||x,h.data=h.data||o,h.soul||(h.soul=y.soul||typeof k=="string"&&k);var r=h.state=h.state||a.state();return typeof o=="function"?(o(function(p){h.data=p,x.put(c,c,h)}),x):h.soul?(h.$=n.$.get(h.soul),h.todo=[{it:h.data,ref:h.$}],h.turn=h.turn||u,h.ran=h.ran||d,(function p(){var g=h.todo,s=g.pop(),_=s.it;s.ref&&s.ref._.id;var S,B,N,e,t;if(m(h,s.ref),(e=s.todo)&&(B=e.pop(),_=_[B],e.length&&g.push(s)),B&&(g.path||(g.path=[])).push(B),!(S=w(_))&&!(t=a.is(_))){if(!Object.plain(_)){d.err(h,"Invalid data: "+b(_)+" at "+(h.via.back(function(T){T.get&&e.push(T.get)},e=[])||e.join("."))+"."+(g.path||[]).join("."));return}for(var i=h.seen||(h.seen=[]),l=i.length;l--;)if(_===(e=i[l]).it){S=_=e.link;break}}if(B&&S)s.node=D(s.node,B,r,_);else{let T=function(j,A){var I=N.link["#"];A&&(A.off(),A.rid(j));var M=I||j.soul||(e=(j.$$||j.$)._||"").soul||e.link||((e=e.put||"")._||"")["#"]||e["#"]||((e=j.put||"")&&j.$$?e["#"]:(e["="]||e[":"]||"")["#"]);if(!I&&m(h,j.$),!M&&!s.link["#"]){(s.wait||(s.wait=[])).push(function(){T(j,A)});return}M||(M=[],(j.$$||j.$).back(function(J){if(e=J.soul||J.link)return M.push(e);M.push(J.get)}),M=M.reverse().join("/")),N.link["#"]=M,!t&&(((h.graph||(h.graph={}))[M]=N.node||(N.node={_:{}}))._["#"]=M),delete h.wait[$],N.wait&&setTimeout.each(N.wait,function(J){J&&J()}),h.ran(h)};if(!h.seen){d.err(h,"Data at root of graph must be a node (an object).");return}h.seen.push(N={it:_,link:{},todo:t?[]:Object.keys(_).sort().reverse(),path:(g.path||[]).slice(),up:s}),s.node=D(s.node,B,r,N.link),!t&&N.todo.length&&g.push(N);var $=h.seen.length;(h.wait||(h.wait={}))[$]="",e=(N.ref=t?_:B?s.ref.get(B):s.ref)._,(e=_&&(_._||"")["#"]||e.soul||e.link)?T({soul:e}):N.ref.get(T,{run:h.run,v2020:1,out:{get:{".":" "}}})}if(!g.length)return h.ran(h);h.turn(p)})(),x):(v(h),x)};function m(o,k){if(k){k=(k._||"").id||k;var h=o.root.stun||(o.root.stun={on:a.on}),x={},y;o.stun||(o.stun=h.on("stun",function(){})),(y=h.on(""+k))&&y.the.last.next(x),!(x.run>=o.run)&&h.on(""+k,function(n){if(o.stun.end){this.off(),this.to.next(n);return}n.run=n.run||o.run,n.stun=n.stun||o.stun})}}function d(o){if(o.err){d.end(o.stun,o.root);return}if(!(o.todo.length||o.end||!Object.empty(o.wait))){o.end=1;var k=o.$.back(-1)._,h=k.root,x=k.ask(function(p){h.on("ack",p),p.err&&!p.lack&&a.log(p),++y>(o.acks||0)&&this.off(),o.ack&&o.ack(p,this)},o.opt),y=0,n=o.stun,r;(r=function(){n&&(d.end(n,h),setTimeout.each(Object.keys(n=n.add||""),function(p){(p=n[p])&&p()}))}).hatch=r,o.ack&&!o.ok&&(o.ok=o.acks||9),o.via._.on("out",{put:o.out=o.graph,ok:o.ok&&{"@":o.ok+1},opt:o.opt,"#":x,_:r})}}d.end=function(o,k){o.end=f,o.the.to===o&&o===o.the.last&&delete k.stun,o.off()},d.err=function(o,k){(o.ack||f).call(o,o.out={err:o.err=a.log(k)}),o.ran(o)};function v(o){var k=o.via._,h;o.via=o.via.back(function(x){if(x.soul||!x.get)return x.$;h=o.data,(o.data={})[x.get]=h}),(!o.via||!o.via._.soul)&&(o.via=k.root.$.get(((o.data||"")._||"")["#"]||k.$.back("opt.uuid")())),o.via.put(o.data,o.ack,o)}function b(o,k){return o&&(k=o.constructor)&&k.name||typeof o}var c,f=function(){},u=setTimeout.turn,w=a.valid,D=a.state.ify})(O,"./put"),O(function(E){var a=O("./root");O("./chain"),O("./back"),O("./put"),O("./get"),E.exports=a})(O,"./index"),O(function(E){var a=O("./index");a.chain.on=function(v,b,c,f){var u=this,w=u._;w.root;var D;if(typeof v=="string")return b?(D=w.on(v,b,c||w,f),c&&c.$&&(c.subs||(c.subs=[])).push(D),u):w.on(v);var o=b;return(o=o===!0?{change:!0}:o||{}).not=1,o.on=1,u.get(v,o),u},a.chain.once=function(v,b){if(b=b||{},!v)return m(this);var c=this,f=c._,u=f.root;f.put;var w=String.random(7),D;return c.get(function(o,k,h,x){var y=this,n=y._,r=n.one||(n.one={});if(x.stun||r[w]==="")return;if((D=a.valid(o))===!0){p();return}if(typeof D=="string")return;clearTimeout((f.one||"")[w]),clearTimeout(r[w]),r[w]=setTimeout(p,b.wait||99);function p(g){if(!n.has&&!n.soul&&(n={put:o,get:k}),d===(D=n.put)&&(D=((h.$$||"")._||"").put),typeof a.valid(D)=="string"&&(D=u.$.get(D)._.put,D===d&&!g)){r[w]=setTimeout(function(){p(1)},b.wait||99);return}x.stun||r[w]!==""&&(r[w]="",(f.soul||f.has)&&x.off(),v.call(y,D,n.get),clearTimeout(r[w]))}},{on:1}),c};function m(v,b,c){return a.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(c=v.chain())._.nix=v.once(function(f,u){c._.on("in",this._)}),c._.lex=v._.lex,c}a.chain.off=function(){var v=this,b=v._,c,f=b.back;if(f)return b.ack=0,(c=f.next)&&c[b.get]&&delete c[b.get],(c=f.any)&&(delete f.any,f.any={}),(c=f.ask)&&delete c[b.get],(c=f.put)&&delete c[b.get],(c=b.soul)&&delete f.root.graph[c],(c=b.map)&&Object.keys(c).forEach(function(u,w){w=c[u],w.link&&f.root.$.get(w.link).off()}),(c=b.next)&&Object.keys(c).forEach(function(u,w){w=c[u],w.$.off()}),b.on("off",{}),v};var d})(O,"./on"),O(function(E){var a=O("./index"),m=a.chain.get.next;a.chain.get.next=function(c,f){var u;return Object.plain(f)?(u=((u=f["#"])||"")["="]||u)?c.get(u):((u=c.chain()._).lex=f,c.on("in",function(w){String.match(w.get||(w.put||"")["."],f["."]||f["#"]||f)&&u.on("in",w),this.to.next(w)}),u.$):(m||v)(c,f)},a.chain.map=function(c,f,u){var w=this,D=w._,o,k;return Object.plain(c)&&(o=c["."]?c:{".":c},c=b),c?(a.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),k=w.chain(),w.map().on(function(h,x,y,n){var r=(c||v).call(this,h,x,y,n);if(b!==r){if(h===r)return k._.on("in",y);if(a.is(r))return k._.on("in",r._);var p={};Object.keys(y.put).forEach(function(g){p[g]=y.put[g]},p),p["="]=r,k._.on("in",{get:x,put:p})}}),k):((k=D.each)||((D.each=k=w.chain())._.lex=o||k._.lex||D.lex,k._.nix=w.back("nix"),w.on("in",d,k._)),k)};function d(c){this.to.next(c);var f=this.as,u=c.$,w=u._,D=c.put,o;!w.soul&&!c.$$||(o=f.lex)&&!String.match(c.get||(D||"")["."],o["."]||o["#"]||o)||a.on.link(c,f)}var v=function(){},b})(O,"./map"),O(function(E){var a=O("./index");a.chain.set=function(m,d,v){var b=this,c=b.back(-1),f,u;return d=d||function(){},v=v||{},v.item=v.item||m,(f=((m||"")._||"")["#"])&&((m={})["#"]=f),typeof(u=a.valid(m))=="string"?b.get(f=u).put(m,d,v):a.is(m)?(b.put(function(w){m.get(function(D,o,k){if(!D)return d.call(b,{err:a.log('Only a node can be linked! Not "'+k.put+'"!')});(u={})[D]={"#":D},w(u)},!0)}),m):(Object.plain(m)&&(m=c.get(f=b.back("opt.uuid")()).put(m)),b.get(f||c.back("opt.uuid")(7)).put(m,d,v))}})(O,"./set"),O(function(E){O("./shim");var a=function(){},m=JSON.parseAsync||function(c,f,u){var w,D=+new Date;try{f(w,JSON.parse(c,u),d.sucks(+new Date-D))}catch(o){f(o)}},d=JSON.stringifyAsync||function(c,f,u,w){var D,o=+new Date;try{f(D,JSON.stringify(c,u,w),d.sucks(+new Date-o))}catch(k){f(k)}};d.sucks=function(c){c>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),d.sucks=a)};function v(c){var f=function(){},u=c.opt||{};u.log=u.log||console.log,u.gap=u.gap||u.wait||0,u.max=u.max||(u.memory?u.memory*999*999:3e8)*.3,u.pack=u.pack||u.max*.01*.01,u.puff=u.puff||9;var w=setTimeout.turn||setTimeout,D=c.dup,o=D.check,k=D.track,h=f.hear=function(n,r){if(n){if(u.max<=n.length)return f.say({dam:"!",err:"Message too big!"},r);f===this&&(h.d+=n.length||0,++h.c);var p=r.SH=+new Date,g=n[0],s;if(g==="["){m(n,function(_,S){if(_||!S)return f.say({dam:"!",err:"DAM JSON parse error."},r);console.STAT&&console.STAT(+new Date,S.length,"# on hear batch");var B=u.puff;(function N(){for(var e=+new Date,t=0,i;t<B&&(i=S[t++]);)f.hear(i,r);S=S.slice(t),console.STAT&&console.STAT(e,+new Date-e,"hear loop"),x(r),S.length&&w(N,0)})()}),n="";return}if(g==="{"||(n["#"]||Object.plain(n))&&(s=n)){if(s)return h.one(s,r,p);m(n,function(_,S){if(_||!S)return f.say({dam:"!",err:"DAM JSON parse error."},r);h.one(S,r,p)});return}}};h.one=function(n,r,N){var g,s,_,S,B;if(n.DBG&&(n.DBG=B={DBG:n.DBG}),B&&(B.h=N),B&&(B.hp=+new Date),(g=n["#"])||(g=n["#"]=String.random(9)),!(_=o(g))&&(s=n["##"],!(s&&(_=n["@"]||n.get&&g)&&D.check(S=_+s)))){if((n._=function(){}).via=f.leap=r,(_=n["><"])&&typeof _=="string"&&_.slice(0,99).split(",").forEach(function(e){this[e]=1},n._.yo={}),_=n.dam){(_=f.hear[_])&&_(n,r,c),k(g);return}(_=n.ok)&&(n._.near=_["/"]);var N=+new Date;B&&(B.is=N),r.SI=g,k.ed=function(e){g===e&&(k.ed=0,(e=D.s[g])&&(e.via=r,n.get&&(e.it=n)))},c.on("in",f.last=n),B&&(B.hd=+new Date),console.STAT&&console.STAT(N,+new Date-N,n.get?"msg get":n.put?"msg put":"msg"),k(g),S&&k(S),f.leap=f.last=null}},h.c=h.d=0,(function(){var n=0,r;f.hash=function(s,_){var S,B,N,e=+new Date;d(s.put,function t(i,l){var $=(B||(B=N=l||"")).slice(0,32768);if(S=String.hash($,S),B=B.slice(32768),B){w(t,0);return}console.STAT&&console.STAT(e,+new Date-e,"say json+hash"),s._.$put=N,s["##"]=S,f.say(s,_),delete s._.$put},p)};function p(s,_){var S;return _ instanceof Object?(Object.keys(_).sort().forEach(g,{to:S={},on:_}),S):_}function g(s){this.to[s]=this.on[s]}f.say=function(s,_){var S;if((S=this)&&(S=S.to)&&S.next&&S.next(s),!s)return!1;var B,N,e,t=s["@"],i=s._||(s._=function(){}),l=s.DBG,$=+new Date;if(i.y=i.y||$,_||l&&(l.y=$),(B=s["#"])||(B=s["#"]=String.random(9)),!r&&k(B),!(N=s["##"])&&b!==s.put&&!i.via&&t){f.hash(s,_);return}if(!_&&t&&(_=(S=D.s[t])&&(S.via||(S=S.it)&&(S=S._)&&S.via)||(S=f.last)&&t===S["#"]&&f.leap),!_&&t)return D.s[t]?void 0:(console.STAT&&console.STAT(+new Date,++n,"total no peer to ack to"),!1);if(t&&!s.put&&!N&&((D.s[t]||"").it||"")["##"])return!1;if(!_&&f.way)return f.way(s);if(l&&(l.yh=+new Date),!(e=i.raw)){f.raw(s,_);return}if(l&&(l.yr=+new Date),!_||!_.id){if(!Object.plain(_||u.peers))return!1;var $=+new Date;u.puff;var T=u.peers,j=Object.keys(_||u.peers||{});console.STAT&&console.STAT($,+new Date-$,"peer keys"),(function M(){var J=+new Date;r=1;var P=i.raw;i.raw=e;for(var q=0,C;q<9&&(C=(j||"")[q++]);)(C=T[C]||(_||"")[C])&&f.say(s,C);i.raw=P,r=0,j=j.slice(q),console.STAT&&console.STAT(J,+new Date-J,"say loop"),j.length&&(w(M,0),t&&k(t))})();return}if(!_.wire&&f.wire&&f.wire(_),B!==_.last){if(_.last=B,_===i.via||(S=i.yo)&&(S[_.url]||S[_.pid]||S[_.id]))return!1;if(console.STAT&&console.STAT($,((l||i).yp=+new Date)-(i.y||$),"say prep"),!r&&t&&k(t),_.batch){if(_.tail=(S=_.tail||0)+e.length,_.tail<=u.pack){_.batch+=(S?",":"")+e;return}x(_)}_.batch="[";var A=+new Date;setTimeout(function(){console.STAT&&console.STAT(A,+new Date-A,"0ms TO"),x(_)},u.gap),y(e,_),console.STAT&&t===_.SI&&console.STAT($,+new Date-_.SH,"say ack")}},f.say.c=f.say.d=0,f.raw=function(s,_){if(!s)return"";var S=s._||{},B,N;if(N=S.raw)return N;if(typeof s=="string")return s;var e=s["##"],t=s["@"];if(e&&t){if(!S.via&&o(t+e))return!1;if(N=(D.s[t]||"").it){if(e===N["##"])return!1;N["##"]||(N["##"]=e)}}if(!s.dam&&!s["@"]){var i=0,l=[];N=u.peers;for(var $ in N){var T=N[$];if(l.push(T.url||T.pid||T.id),++i>6)break}i>1&&(s["><"]=l.join())}if(s.put&&(N=s.ok)&&(s.ok={"@":(N["@"]||1)-1,"/":N["/"]==s._.near?f.near:N["/"]}),B=S.$put){N={},Object.keys(s).forEach(function(A){N[A]=s[A]}),N.put=":])([:",d(N,function(A,I){if(!A){var M=+new Date;N=I.indexOf('"put":":])([:"'),j(b,I=I.slice(0,N+6)+B+I.slice(N+14)),console.STAT&&console.STAT(M,+new Date-M,"say slice")}});return}d(s,j);function j(A,I){A||(S.raw=I,f.say(s,_))}}})();function x(n){var r=n.batch,p=typeof r=="string";if(p&&(r+="]"),n.batch=n.tail=null,!!r&&!(p?3>r.length:!r.length)){if(!p)try{r=r.length===1?r[0]:JSON.stringify(r)}catch(g){return u.log("DAM JSON stringify error",g)}r&&y(r,n)}}function y(n,r){try{var p=r.wire;r.say?r.say(n):p.send&&p.send(n),f.say.d+=n.length||0,++f.say.c}catch{(r.queue=r.queue||[]).push(n)}}return f.near=0,f.hi=function(n){var r=n.wire,p;if(!r){f.wire(n.length&&{url:n,id:n}||n);return}n.id?u.peers[n.url||n.id]=n:(p=n.id=n.id||n.url||String.random(9),f.say({dam:"?",pid:c.opt.pid},u.peers[p]=n),delete D.s[n.last]),n.met||(f.near++,n.met=+new Date,c.on("hi",n)),p=n.queue,n.queue=[],setTimeout.each(p||[],function(g){y(g,n)},0,9)},f.bye=function(n){n.met&&--f.near,delete n.met,c.on("bye",n);var r=+new Date;r=r-(n.met||r),f.bye.time=((f.bye.time||r)+r)/2},f.hear["!"]=function(n,r){u.log("Error:",n.err)},f.hear["?"]=function(n,r){n.pid&&(r.pid||(r.pid=n.pid),n["@"])||(f.say({dam:"?",pid:u.pid,"@":n["#"]},r),delete D.s[r.last])},f.hear.mob=function(n,r){if(n.peers){var p=Object.keys(n.peers),g=p[Math.random()*p.length>>0];g&&(f.bye(r),f.hi(g))}},c.on("create",function(n){n.opt.pid=n.opt.pid||String.random(9),this.to.next(n),n.on("out",f.say)}),c.on("bye",function(n,r){n=u.peers[n.id||n]||n,this.to.next(n),n.bye?n.bye():(r=n.wire)&&r.close&&r.close(),delete u.peers[n.id],n.wire=null}),c.on("bye",function(n,r){this.to.next(n),(r=console.STAT)&&(r.peers=f.near),(r=n.url)&&setTimeout(function(){},u.lack||9e3)}),c.on("hi",function(n,r){if(this.to.next(n),(r=console.STAT)&&(r.peers=f.near),!u.super){var p=Object.keys(c.next||"");p.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(p,function(g){var s=c.next[g];if(u.super||(s.ask||"")[""]){f.say({get:{"#":g}},n);return}setTimeout.each(Object.keys(s.ask||""),function(_){_&&f.say({"##":String.hash((c.graph[g]||"")[_]),get:{"#":g,".":_}},n)})})}}),f}var b;try{E.exports=v}catch{}})(O,"./mesh"),O(function(E){var a=O("./index");a.Mesh=O("./mesh"),a.on("opt",function(d){if(this.to.next(d),d.once)return;var v=d.opt;if(v.WebSocket===!1)return;var b=a.window||{},c=v.WebSocket||b.WebSocket||b.webkitWebSocket||b.mozWebSocket;if(!c)return;v.WebSocket=c;var f=v.mesh=v.mesh||a.Mesh(d);f.wire||v.wire,f.wire=v.wire=u;function u(k){try{if(!k||!k.url)return x&&x(k);var h=k.url.replace(/^http/,"ws"),x=k.wire=new v.WebSocket(h);return x.onclose=function(){D(k),v.mesh.bye(k)},x.onerror=function(y){D(k)},x.onopen=function(){v.mesh.hi(k)},x.onmessage=function(y){y&&v.mesh.hear(y.data||y,k)},x}catch{v.mesh.bye(k)}}setTimeout(function(){!v.super&&d.on("out",{dam:"hi"})},1);var w=2*999;function D(k){clearTimeout(k.defer),v.peers[k.url]&&(o&&k.retry<=0||(k.retry=(k.retry||v.retry+1||60)-(-k.tried+(k.tried=+new Date)<w*4?1:0),k.defer=setTimeout(function h(){if(o&&o.hidden)return setTimeout(h,w);u(k)},w)))}var o=""+m!=typeof document&&document});var m})(O,"./websocket"),O(function(E){if(!(typeof Gun>"u")){var a=function(){},m;try{m=(Gun.window||a).localStorage}catch{}m||(Gun.log("Warning: No localStorage exists to persist data to!"),m={setItem:function(v,b){this[v]=b},removeItem:function(v){delete this[v]},getItem:function(v){return this[v]}});var d=JSON.stringifyAsync||function(v,b,c,f){var u;try{b(u,JSON.stringify(v,c,f))}catch(w){b(w)}};Gun.on("create",function v(b){this.to.next(b);var c=b.opt;b.graph;var f=[],u,w,D,o;if(c.localStorage===!1)return;c.prefix=c.file||"gun/";try{u=v[c.prefix]=v[c.prefix]||JSON.parse(D=m.getItem(c.prefix))||{}}catch{u=v[c.prefix]={}}D=(D||"").length,b.on("get",function(h){this.to.next(h);var x=h.get,y,n,r,p;!x||!(y=x["#"])||(n=u[y]||p,n&&(r=x["."])&&!Object.plain(r)&&(n=Gun.state.ify({},r,Gun.state.is(n,r),n[r],y)),Gun.on.get.ack(h,n))}),b.on("put",function(h){this.to.next(h);var x=h.put,y=x["#"],n=x["."],r=h["#"],p=h.ok||"";if((b.next||"")[y]){if(u[y]=Gun.state.ify(u[y],n,x[">"],x[":"],y),o&&D>4999880){b.on("in",{"@":r,err:"localStorage max!"});return}!h["@"]&&(!h._.via||Math.random()<p["@"]/p["/"])&&f.push(r),!w&&(w=setTimeout(k,9+D/333))}});function k(){if(!f.length&&((setTimeout.turn||"").s||"").length){setTimeout(k,99);return}var h=f;clearTimeout(w),w=!1,f=[],d(u,function(x,y){try{!x&&m.setItem(c.prefix,y)}catch(n){x=o=n||"localStorage failure"}x&&(Gun.log(x+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),b.on("localStorage:error",{err:x,get:c.prefix,put:u})),D=y.length,setTimeout.each(h,function(n){b.on("in",{"@":n,err:x,ok:0})},0,99)})}})}})(O,"./localStorage")})(),(function(){var N;if(""+N!=typeof Gun){var O=function(e){console.warn("Warning! Deprecated internal utility will break in next version:",e)},G=Gun;G.fn=G.fn||{is:function(e){return O("fn"),!!e&&typeof e=="function"}},G.bi=G.bi||{is:function(e){return O("bi"),e instanceof Boolean||typeof e=="boolean"}},G.num=G.num||{is:function(e){return O("num"),!E(e)&&(e-parseFloat(e)+1>=0||e===1/0||e===-1/0)}},G.text=G.text||{is:function(e){return O("text"),typeof e=="string"}},G.text.ify=G.text.ify||function(e){return O("text.ify"),G.text.is(e)?e:typeof JSON<"u"?JSON.stringify(e):e&&e.toString?e.toString():e},G.text.random=G.text.random||function(e,t){O("text.random");var i="";for(e=e||24,t=t||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";e>0;)i+=t.charAt(Math.floor(Math.random()*t.length)),e--;return i},G.text.match=G.text.match||function(e,t){var i,l;return O("text.match"),typeof e!="string"?!1:(typeof t=="string"&&(t={"=":t}),t=t||{},i=t["="]||t["*"]||t[">"]||t["<"],e===i?!0:l!==t["="]?!1:(i=t["*"]||t[">"]||t["<"],e.slice(0,(i||"").length)===i?!0:l!==t["*"]?!1:l!==t[">"]&&l!==t["<"]?e>=t[">"]&&e<=t["<"]:l!==t[">"]&&e>=t[">"]||l!==t["<"]&&e<=t["<"]))},G.text.hash=G.text.hash||function(e,t){if(O("text.hash"),typeof e=="string"){if(t=t||0,!e.length)return t;for(var i=0,l=e.length,$;i<l;++i)$=e.charCodeAt(i),t=(t<<5)-t+$,t|=0;return t}},G.list=G.list||{is:function(e){return O("list"),e instanceof Array}},G.list.slit=G.list.slit||Array.prototype.slice,G.list.sort=G.list.sort||function(e){return O("list.sort"),function(t,i){return!t||!i?0:(t=t[e],i=i[e],t<i?-1:t>i?1:0)}},G.list.map=G.list.map||function(e,t,i){return O("list.map"),S(e,t,i)},G.list.index=1,G.obj=G.boj||{is:function(e){return O("obj"),e?e instanceof Object&&e.constructor===Object||Object.prototype.toString.call(e).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},G.obj.put=G.obj.put||function(e,t,i){return O("obj.put"),(e||{})[t]=i,e},G.obj.has=G.obj.has||function(e,t){return O("obj.has"),e&&Object.prototype.hasOwnProperty.call(e,t)},G.obj.del=G.obj.del||function(e,t){if(O("obj.del"),!!e)return e[t]=null,delete e[t],e},G.obj.as=G.obj.as||function(e,t,i,l){return O("obj.as"),e[t]=e[t]||(l===i?{}:i)},G.obj.ify=G.obj.ify||function(e){if(O("obj.ify"),r(e))return e;try{e=JSON.parse(e)}catch{e={}}return e},(function(){var e;function t(i,l){g(this,l)&&e!==this[l]||(this[l]=i)}G.obj.to=G.obj.to||function(i,l){return O("obj.to"),l=l||{},S(i,t,l),l}})(),G.obj.copy=G.obj.copy||function(e){return O("obj.copy"),e&&JSON.parse(JSON.stringify(e))},(function(){function e(t,i){var l=this.n,$;if(!(l&&(i===l||r(l)&&g(l,i)))&&$!==i)return!0}G.obj.empty=G.obj.empty||function(t,i){return O("obj.empty"),t?!S(t,e,{n:i}):!0}})(),(function(){function e(l,$){if(arguments.length===2){e.r=e.r||{},e.r[l]=$;return}e.r=e.r||[],e.r.push(l)}var t=Object.keys,i;Object.keys=Object.keys||function(l){return i(l,function($,T,j){j(T)})},G.obj.map=i=G.obj.map||function(l,$,T){O("obj.map");var j,A=0,I,M,J,P,q=typeof $=="function";if(e.r=j,t&&r(l)&&(J=t(l),P=!0),T=T||{},E(l)||J)for(I=(J||l).length;A<I;A++){var C=A+G.list.index;if(q){if(M=P?$.call(T,l[J[A]],J[A],e):$.call(T,l[A],C,e),M!==j)return M}else if($===l[P?J[A]:A])return J?J[A]:C}else for(A in l)if(q){if(g(l,A)&&(M=T?$.call(T,l[A],A,e):$(l[A],A,e),M!==j))return M}else if($===l[A])return A;return q?e.r:G.list.index?0:-1}})(),G.time=G.time||{},G.time.is=G.time.is||function(e){return O("time"),e?e instanceof Date:+new Date().getTime()};var y=G.fn.is,E=G.list.is,n=G.obj,r=n.is,g=n.has,S=n.map,a={};a.is=function(e){return O("val.is"),e===N?!1:e===null?!0:e===1/0?!1:v(e)||d(e)||o(e)?!0:a.link.is(e)||!1},a.link=a.rel={_:"#"},(function(){a.link.is=function(t){if(O("val.link.is"),t&&t[m]&&!t._&&r(t)){var i={};if(S(t,e,i),i.id)return i.id}return!1};function e(t,i){var l=this;if(l.id)return l.id=!1;if(i==m&&v(t))l.id=t;else return l.id=!1}})(),a.link.ify=function(e){return O("val.link.ify"),_({},m,e)},G.obj.has._=".";var m=a.link._,N,d=G.bi.is,o=G.num.is,v=G.text.is,n=G.obj,r=n.is,_=n.put,S=n.map;G.val=G.val||a;var b={_:"_"};b.soul=function(e,t){return O("node.soul"),e&&e._&&e._[t||u]},b.soul.ify=function(e,t){return O("node.soul.ify"),t=typeof t=="string"?{soul:t}:t||{},e=e||{},e._=e._||{},e._[u]=t.soul||e._[u]||f(),e},b.soul._=a.link._,(function(){b.is=function(t,i,l){O("node.is");var $;return r(t)&&($=b.soul(t))?!S(t,e,{as:l,cb:i,s:$,n:t}):!1};function e(t,i){if(i!==b._){if(!a.is(t))return!0;this.cb&&this.cb.call(this.as,t,i,this.n,this.s)}}})(),(function(){b.ify=function(t,i,l){return O("node.ify"),i?typeof i=="string"?i={soul:i}:typeof i=="function"&&(i={map:i}):i={},i.map&&(i.node=i.map.call(l,t,N,i.node||{})),(i.node=b.soul.ify(i.node||{},i))&&S(t,e,{o:i,as:l}),i.node};function e(t,i){var l=this.o,$,T;if(l.map){$=l.map.call(this.as,t,""+i,l.node),T===$?p(l.node,i):l.node&&(l.node[i]=$);return}a.is(t)&&(l.node[i]=t)}})();var n=G.obj,r=n.is,p=n.del,S=n.map,c=G.text,f=c.random,u=b.soul._,N;G.node=G.node||b;var w=G.state;w.lex=function(){return O("state.lex"),w().toString(36).replace(".","")},w.to=function(e,t,i){O("state.to");var l=(e||{})[t];return r(l)&&(l=B(l)),w.ify(i,t,w.is(e,t),l,b.soul(e))},(function(){w.map=function(t,i,l){O("state.map");var $,T=r(T=t||i)?T:null;return t=y(t=t||i)?t:null,T&&!t?(i=o(i)?i:w(),T[h]=T[h]||{},S(T,e,{o:T,s:i}),T):(l=l||r(i)?i:$,i=o(i)?i:w(),function(j,A,I,M){if(!t)return e.call({o:I,s:i},j,A),j;t.call(l||this||{},j,A,I,M),!(g(I,A)&&$===I[A])&&e.call({o:I,s:i},j,A)})};function e(t,i){h!==i&&w.ify(this.o,i,this.s)}})();var n=G.obj;n.as;var g=n.has,r=n.is,S=n.map,B=n.copy,D=G.num,o=D.is,k=G.fn,y=k.is,h=b._,N,x={};(function(){x.is=function(i,l,$,T){return O("graph.is"),!i||!r(i)||s(i)?!1:!S(i,e,{cb:l,fn:$,as:T})};function e(i,l){if(!i||l!==b.soul(i)||!b.is(i,this.fn,this.as))return!0;this.cb&&(t.n=i,t.as=this.as,this.cb.call(t.as,i,l,t))}function t(i){i&&b.is(t.n,i,t.as)}})(),(function(){x.ify=function(T,j,A){O("graph.ify");var I={path:[],obj:T};return j?typeof j=="string"?j={soul:j}:typeof j=="function"&&(j.map=j):j={},typeof A=="string"&&(j.soul=j.soul||A,A=N),j.soul&&(I.link=a.link.ify(j.soul)),j.shell=(A||{}).shell,j.graph=j.graph||{},j.seen=j.seen||[],j.as=j.as||A,e(j,I),j.root=I.node,j.graph};function e(T,j){var A;return(A=$(T,j))?A:(j.env=T,j.soul=i,b.ify(j.obj,t,j)&&(j.link=j.link||a.link.ify(b.soul(j.node)),j.obj!==T.shell&&(T.graph[a.link.is(j.link)]=j.node)),j)}function t(T,j,A){var I=this,M=I.env,J,P;if(b._===j&&g(T,a.link._))return A._;if(J=l(T,j,A,I,M)){if(j||(I.node=I.node||A||{},g(T,b._)&&b.soul(T)&&(I.node._=B(T._)),I.node=b.soul.ify(I.node,a.link.is(I.link)),I.link=I.link||a.link.ify(b.soul(I.node))),(P=M.map)&&(P.call(M.as||{},T,j,A,I),g(A,j))){if(T=A[j],N===T){p(A,j);return}if(!(J=l(T,j,A,I,M)))return}if(!j)return I.node;if(J===!0)return T;if(P=e(M,{obj:T,path:I.path.concat(j)}),!!P.node)return P.link}}function i(T){var j=this,A=a.link.is(j.link),I=j.env.graph;j.link=j.link||a.link.ify(T),j.link[a.link._]=T,j.node&&j.node[b._]&&(j.node[b._][a.link._]=T),g(I,A)&&(I[T]=I[A],p(I,A))}function l(T,j,A,I,M){var J;if(a.is(T))return!0;if(r(T))return 1;if(J=M.invalid)return T=J.call(M.as||{},T,j,A),l(T,j,A,I,M);M.err="Invalid value at '"+I.path.concat(j).join(".")+"'!",G.list.is(T)&&(M.err+=" Use `.set(item)` instead of an Array.")}function $(T,j){for(var A=T.seen,I=A.length,M;I--;)if(M=A[I],j.obj===M.obj)return M;A.push(j)}})(),x.node=function(e){O("graph.node");var t=b.soul(e);if(t)return _({},t,e)},(function(){x.to=function(t,i,l){if(O("graph.to"),!!t){var $={};return l=l||{seen:{}},S(t[i],e,{obj:$,graph:t,opt:l}),$}};function e(t,i){var l,$;if(b._===i){if(s(t,a.link._))return;this.obj[i]=B(t);return}if(!(l=a.link.is(t))){this.obj[i]=t;return}if($=this.opt.seen[l]){this.obj[i]=$;return}this.obj[i]=this.opt.seen[l]=x.to(this.graph,l,this.opt)}})();var y=G.fn.is,n=G.obj,r=n.is,p=n.del,g=n.has,s=n.empty,_=n.put,S=n.map,B=n.copy,N;G.graph=G.graph||x}})()})(V)),V.exports}var Q,L;function ot(){return L||(L=1,Q=rt()),Q}var tt=ot();const ut=et(tt),ft=nt({__proto__:null,default:ut},[tt]);export{ft as b};
